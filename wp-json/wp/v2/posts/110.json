{"id":110,"date":"2017-11-27T22:44:16","date_gmt":"2017-11-27T21:44:16","guid":{"rendered":"https:\/\/domo.easter.fr\/?p=110"},"modified":"2017-12-11T14:12:31","modified_gmt":"2017-12-11T13:12:31","slug":"detecteur-de-mouvement-v2","status":"publish","type":"post","link":"https:\/\/domo.easter.fr\/2017\/11\/27\/detecteur-de-mouvement-v2\/","title":{"rendered":"D\u00e9tecteur de mouvement v2 et v2.1"},"content":{"rendered":"<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone wp-image-64 size-large\" src=\"https:\/\/domo.easter.fr\/wp-content\/uploads\/2017\/06\/domo_lua-1024x205.png\" alt=\"\" width=\"812\" height=\"163\" srcset=\"https:\/\/domo.easter.fr\/wp-content\/uploads\/2017\/06\/domo_lua-1024x205.png 1024w, https:\/\/domo.easter.fr\/wp-content\/uploads\/2017\/06\/domo_lua-300x60.png 300w, https:\/\/domo.easter.fr\/wp-content\/uploads\/2017\/06\/domo_lua-768x154.png 768w, https:\/\/domo.easter.fr\/wp-content\/uploads\/2017\/06\/domo_lua.png 1864w\" sizes=\"auto, (max-width: 812px) 100vw, 812px\" \/><\/p>\n<p>Une petite mise \u00e0 jour du <a href=\"https:\/\/domo.easter.fr\/2017\/06\/26\/detecteur-de-mouvement-lumiere-et-domoticz\/\">script de d\u00e9tection de mouvement<\/a> qui allume une lampe sur d\u00e9tection de mouvement.<\/p>\n<p>Le voici :<\/p>\n<p>[pastacode lang=\u00a0\u00bbc\u00a0\u00bb user=\u00a0\u00bbchatainsim\u00a0\u00bb repos=\u00a0\u00bbscripts_domoticz\u00a0\u00bb path_id=\u00a0\u00bbmotionv2.lua\u00a0\u00bb revision=\u00a0\u00bb\u00a0\u00bb highlight=\u00a0\u00bb\u00a0\u00bb lines=\u00a0\u00bb\u00a0\u00bb provider=\u00a0\u00bbgithub\u00a0\u00bb\/]<\/p>\n<p>Il y a deux diff\u00e9rences. La premi\u00e8re, je n&rsquo;utilise plus <em>timeofday[<span class=\"pl-s\"><span class=\"pl-pds\">&lsquo;<\/span>Nighttime<span class=\"pl-pds\">&lsquo;<\/span><\/span>]<\/em> car en p\u00e9riode d&rsquo;hiver, la lampe s&rsquo;\u00e9claire faiblement au alentour de 17h du coup ce n&rsquo;est pas pratique.<\/p>\n<p>J&rsquo;ai donc d\u00e9finis moi m\u00eame les heures avec les variables <em>morning<\/em> et <em>night<\/em>.<\/p>\n<p>Du coup la lampe ne s&rsquo;\u00e9claire faiblement qu&rsquo;entre 23h et 5h du matin. A vous de les changer en fonction.<\/p>\n<p>Deuxi\u00e8me changement, je d\u00e9fini le nom du d\u00e9tecteur de mouvement et de la lampe une seule fois au d\u00e9but du script, comme \u00e7a s&rsquo;il change j&rsquo;ai juste \u00e0 changer le variable <em>motion_sensor<\/em> et <em>light_bulb<\/em> en fonction et je n&rsquo;ai pas besoin de reparcourir tout le script.<\/p>\n<p>EDIT: Voici une v2.1 :<\/p>\n<p>[pastacode lang=\u00a0\u00bbc\u00a0\u00bb user=\u00a0\u00bbchatainsim\u00a0\u00bb repos=\u00a0\u00bbscripts_domoticz\u00a0\u00bb path_id=\u00a0\u00bbmotionv2.1.lua\u00a0\u00bb revision=\u00a0\u00bb\u00a0\u00bb highlight=\u00a0\u00bb\u00a0\u00bb lines=\u00a0\u00bb\u00a0\u00bb provider=\u00a0\u00bbgithub\u00a0\u00bb\/]<\/p>\n<p>J&rsquo;ai rajout\u00e9 la variable nolight qui permet de sp\u00e9cifier \u00e0 partir de quelle heure la lampe ne s&rsquo;allume plus la nuit.<\/p>\n<p>Dans mon cas, la lampe ne s&rsquo;allume plus entre 1h du matin et 6h.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Une petite mise \u00e0 jour du script de d\u00e9tection de mouvement qui allume une lampe sur d\u00e9tection de mouvement. Le voici : [pastacode lang=\u00a0\u00bbc\u00a0\u00bb user=\u00a0\u00bbchatainsim\u00a0\u00bb repos=\u00a0\u00bbscripts_domoticz\u00a0\u00bb path_id=\u00a0\u00bbmotionv2.lua\u00a0\u00bb revision=\u00a0\u00bb\u00a0\u00bb highlight=\u00a0\u00bb\u00a0\u00bb lines=\u00a0\u00bb\u00a0\u00bb provider=\u00a0\u00bbgithub\u00a0\u00bb\/] Il y a deux diff\u00e9rences. La premi\u00e8re, je n&rsquo;utilise plus timeofday[&lsquo;Nighttime&lsquo;] car en p\u00e9riode d&rsquo;hiver, la lampe s&rsquo;\u00e9claire faiblement au alentour de 17h du [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":66,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_crdt_document":"","site-container-style":"default","site-container-layout":"default","site-sidebar-layout":"default","site-transparent-header":"default","disable-article-header":"default","disable-site-header":"default","disable-site-footer":"default","disable-content-area-spacing":"default","iawp_total_views":19,"footnotes":""},"categories":[2,8,4],"tags":[],"class_list":["post-110","post","type-post","status-publish","format-standard","has-post-thumbnail","hentry","category-domoticz","category-light","category-lua"],"_links":{"self":[{"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/posts\/110","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/comments?post=110"}],"version-history":[{"count":6,"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/posts\/110\/revisions"}],"predecessor-version":[{"id":133,"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/posts\/110\/revisions\/133"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/media\/66"}],"wp:attachment":[{"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/media?parent=110"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/categories?post=110"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/domo.easter.fr\/wp-json\/wp\/v2\/tags?post=110"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}